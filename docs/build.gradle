/* This script doesn't actually build anything since the documentation microsite
 * is rendered by GitHub off the 'docs' directory in the master branch. For more
 * see: https://docs.github.com/en/github/working-with-github-pages/setting-up-a-github-pages-site-with-jekyll
 * 
 * To run the microsote locally during editing, cd into the 'docs' directory and
 * run (with Jekyll installed locally):
 *     $ bundle exec jekyll serve --watch
 * 
 * For more see: https://github.com/mooltiverse/nyx/blob/master/CONTRIBUTING.md#contributing-documentation
 */

/*------------------------------------------------------------------------------
  Plugins DSL block
  https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block
------------------------------------------------------------------------------*/
plugins {
}

/*------------------------------------------------------------------------------
  Local sub-project properties
------------------------------------------------------------------------------*/
description = 'The Nyx documentation site'

task updateSiteVariables() {
    description 'Updates the site data file with the current version'
    group = 'Build'

    doLast {
        File file = project.file('_data/nyx.yml')
        file.write  '# Nyx site variables\n'
        file.append '#\n'
        file.append '# ATTENTION: this file is automatically generated by the build process, do not edit manually.\n'
        file.append '\n'
        file.append '# Nyx Version\n'
        file.append '# This variable can be used as {{ site.data.nyx.version }} to parametrize the version of Nyx\n'
        file.append 'version: "'+project.version+'"\n'
    }
}

/*------------------------------------------------------------------------------
  Additional task dependencies
------------------------------------------------------------------------------*/
tasks.assemble.dependsOn tasks.updateSiteVariables
